---
import { Image } from 'astro:assets'
import { getEntry } from 'astro:content'
import WathqnyConfig from '/wathqny.config'
import type { LayoutInterface } from '../../types/components'
import BlogLayout from '../Layout/BlogLayout.astro'
import Breadcrumbs from '../Navigation/breadcrumbs.astro'
import AuthorProfile from './AuthorProfile.astro'

export interface Props extends LayoutInterface {
  authors: {
    data: {
      name: string
      role: string
      profile: string
    }
  }
}

const { title, keywords, description, OGImage, authors } = Astro.props as Props

const authorData = (await getEntry('authors', authors?.id)) as {
  data: {
    name: string
    role: string
    profile: string
  }
}
---

<BlogLayout {title} {description} {keywords} {OGImage}>
  <Breadcrumbs />
  <article>
    <span class="wtq-post-head">
      <h1 class="wtq-main-heading">{title}</h1>
      <AuthorProfile
        name={authorData.data.name}
        role={authorData.data.role}
        image={authorData.data.profile}
      />
      <figure>
        <Image
          class="wtq-cover"
          width={960}
          height={540}
          loading="eager"
          src={OGImage?.src ?? WathqnyConfig.OGImage?.src}
          alt={OGImage?.alt ?? WathqnyConfig.OGImage?.alt}
        />
        <figcaption>
          {OGImage?.alt ?? WathqnyConfig.OGImage?.alt}
        </figcaption>
      </figure>
    </span>
    <main id="main-content">
      <slot />
    </main>
  </article>
</BlogLayout>
